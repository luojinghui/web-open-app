/*!
 * openapp.js v1.0.0
 * https://github.com/luojinghui/launch-app
 * 
 * Licensed MIT © Luo Jinghui
 */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var o in i)("object"==typeof exports?exports:e)[o]=i[o]}}(window,function(){return o={},n.m=i=[function(e,t,i){e.exports=i(1)},function(e,t,i){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=i(2),s=(r.prototype.init=function(){this.systemInfo=n.systemInfo(),this.openStatus={FAILED:"FAILED",SUCCESS:"SUCCESS",UNKNOW:"UNKNOW"}},r.prototype.open=function(){var e=this.options,t=e.applink,i=e.scheme,o=e.intent,n=e.iosUseScheme,s=this.systemInfo,r=s.weixinVersion,a=s.isIOS,l=s.isWeixin,c=s.isAndroid,u=s.isChrome,d=s.isSafari,p=s.isFirefox;if(console.log("init...",this.systemInfo),this.timeoutEvent(),a)l&&r<"7.0.5"?(this.msg="isIosLowVersionWechat",this.locationCall(i)):t?this.locationCall(t):n&&i&&this.locationCall(i);else if(c){if(l&&(this.msg="isAndroidWechat"),u&&!l&&o)return this.locationCall(o),void this.locationCall(i);this.locationCall(i)}else d||p?this.locationByIframeCall(i):this.locationCall(i)},r.prototype.download=function(){var e=this.options,t=e.wechatJumpYYB,i=e.downloadUrl,o=e.yyb,n=e.appstore,s=this.systemInfo,r=s.isIOS,a=s.isWeixin,l=s.isAndroid;if(a&&l)t&&this.locationCall(o);else if(a&&r)t&&this.locationCall(n);else if(l)i?this.locationCall(i):o?this.locationCall(o):console.log("没有配置下载地址");else if(r)this.locationCall(n);else{if(i)return void this.locationCall(i);if(o)return void this.locationCall(o);console.log("没有配置下载地址")}},r.prototype.timeoutEvent=function(){var t=this,i=!1,o=!1,n=!1,e=this.options.timeout,s=this.getVisibilityPrefix(),r=s.property,a=void 0===r?"":r,l=s.eventName,c=void 0===l?"":l,u=this.systemInfo,d=u.isIOS,p=u.isSafari;function f(e){var t=document[a]||e.hidden||"hidden"==document.visibilityState;i=!0,console.log("page hide11: ",t),t&&(o=!0),document.removeEventListener(c,f),document.removeEventListener("baiduboxappvisibilitychange",f)}function m(){console.log("page blur22"),o=i=!0}if(this.systemInfo.isSamsung&&(e=e<=1e3?e+300:e),window.addEventListener("blur",m),document.addEventListener(c,f,!1),document.addEventListener("baiduboxappvisibilitychange",f,!1),!(d&&p&&this.options.iosUseScheme)){console.log("use input event");var h=document.createElement("input"),y=function(e){n||(console.log("input blur33"),o=i=!0)};h.setAttribute("id","input"),h.setAttribute("readonly",""),h.setAttribute("autocomplete","off"),h.setAttribute("type","text"),this.options.copyText&&h.setAttribute("value",this.options.copyText),h.setAttribute("style","opacity: 0; position: fixed; top: 0; left: -999px; width: 1px; height: 1px"),document.body.appendChild(h),h.addEventListener("blur",y),setTimeout(function(){n=!0,h.removeEventListener("blur",y),clearInterval(null),h.remove()},this.options.timeout),h.focus(),this.options.copyText&&(h.select(),h.setSelectionRange(0,h.value.length),document.execCommand("copy"))}this.timer=setTimeout(function(){if(console.log("document.visibilityState:",document.visibilityState),console.log("document.hidden:",document.hidden),i&&o||"hidden"===document.visibilityState||document.hidden)t.openEnd(t.openStatus.SUCCESS);else if(!i){var e="hidden"===document.visibilityState;window.removeEventListener("blur",m),document.removeEventListener(c,f),document.removeEventListener("baiduboxappvisibilitychange",f),e||document.hidden||i?t.openEnd(t.openStatus.UNKNOW):t.openEnd(t.openStatus.FAILED),i=!0}},this.options.timeout)},r.prototype.getVisibilityPrefix=function(){var t;return"hidden"in document?{property:"hidden",eventName:"visibilitychange"}:([{property:"webkit",eventName:"webkitvisibilitychange"},{property:"moz",eventName:"mozvisibilitychange"},{property:"ms",eventName:"msvisibilitychange"},{property:"o",eventName:"ovisibilitychange"}].forEach(function(e){e.property+"Hidden"in document&&(t=e)}),t)},r.prototype.openEnd=function(e){clearTimeout(this.timer),this.options.callback(e,this.msg),this.msg="",this.openStatus.SUCCESS},r.prototype.locationCall=function(e){window.top.location?window.top.location.href=e:window.location?window.location.href=e:document.location&&(document.location.href=e)},r.prototype.locationByIframeCall=function(e){var t=document.createElement("iframe");t.setAttribute("src",e),t.setAttribute("style","display:none"),document.body.appendChild(t),setTimeout(function(){document.body.removeChild(t)},300)},r);function r(e){this.options=o(o({},{timeout:1e3,scheme:"",intent:"",applink:"",yyb:"",appstore:"",downloadUrl:"",wechatJumpYYB:!1,iosUseScheme:!1,copyText:"",callback:function(){}}),e),this.init()}t.default=s,window.OpenApp=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.systemInfo=function(){var e=window.navigator?window.navigator.userAgent:navigator.userAgent,t=e.indexOf("Chrome")||-1,i=-1<e.indexOf("Android")||-1<e.indexOf("Adr"),o=!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),n=/Safari/.test(e)&&!/Chrome/.test(e),s=0<t,r=0<=e.indexOf("Firefox"),a=0<=e.indexOf("SamsungBrowser");return{isAndroid:i,isIOS:o,isSafari:n,isChrome:s,isFirefox:r,isWeixin:"micromessenger"==e.toLowerCase().match(/MicroMessenger/i),isSamsung:a,weixinVersion:function(){var t=[];try{t=navigator.appVersion.match(/micromessenger\/(\d+\.\d+\.\d+)/i)||[]}catch(e){t=[]}return t[1]||""}()}}}],n.c=o,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0);function n(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var i,o});